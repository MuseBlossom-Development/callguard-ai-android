┌─────────────────────────────────────────────────────────────────────┐
│                         🚀 앱 시작                                    │
└─────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────┐
│           📱 SplashActivity (스플래시 화면)                          │
│   • 애니메이션 (로고 → 텍스트)                                      │
│   • AI 모델 파일 다운로드 (ggml-small.bin)                          │
│   • 진행률 표시                                                     │
└─────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────┐
│                    🔒 권한 요청 단계                                 │
│   1. 오버레이 권한 (SYSTEM_ALERT_WINDOW)                            │
│   2. 기타 권한들 (EtcPermissionActivity)                             │
│      - 통화 기록 (READ_PHONE_STATE)                                 │
│      - 오디오 녹음 (RECORD_AUDIO)                                   │
│      - 접근성 서비스                                                │
└─────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────┐
│              🏠 MainActivity (메인 화면)                             │
│   • 앱 상태 표시 ("정상작동중" / "동작안함")                          │
│   • 접근성 서비스 권한 확인                                          │
│   • 네트워크 상태 모니터링                                          │
└─────────────────────────────────────────────────────────────────────┘
                                    ↓
                        📞 전화 수신/발신 감지
                                    ↓
┌─────────────────────────────────────────────────────────────────────┐
│           🎯 PhoneBroadcastReceiver                                 │
│   • PHONE_STATE_CHANGED 감지                                        │
│   • NEW_OUTGOING_CALL 감지                                          │
│   • CallRecordingService 시작                                       │
└─────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────┐
│           🔊 CallRecordingService (핵심 서비스)                       │
│                                                                     │
│   📋 통화 상태별 처리:                                               │
│   • RINGING: 수신 전화 감지                                         │
│   • OFFHOOK: 통화 시작 → 녹음 시작                                  │
│   • IDLE: 통화 종료 → 녹음 중지                                     │
│                                                                     │
│   🎤 녹음 프로세스:                                                  │
│   • Recorder 클래스로 오디오 캡처                                    │
│   • 60초마다 WAV 파일 생성                                          │
│   • 실시간 딥보이스 감지                                            │
│                                                                     │
│   🧠 AI 분석 파이프라인:                                             │
│   1. Whisper → 음성을 텍스트로 변환                                  │
│   2. KoBERT → 피싱 텍스트 분석                                       │
│   3. 딥보이스 모델 → 합성음성 탐지                                   │
│                                                                     │
│   📱 오버레이 UI:                                                    │
│   • 통화 중 실시간 위협 상태 표시                                    │
│   • 드래그 가능한 플로팅 위젯                                        │
│   • 피싱/딥보이스 감지 결과 시각화                                   │
└─────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────┐
│                🚨 위협 감지 및 알림                                   │
│                                                                     │
│   딥보이스 감지:                                                     │
│   • 60% 이상: 빨간색 경고 (진동)                                     │
│   • 50-59%: 노란색 주의 (진동)                                      │
│   • 50% 미만: 초록색 안전                                           │
│                                                                     │
│   피싱 감지:                                                        │
│   • "phishing" 결과: 빨간색 경고                                     │
│   • "normal" 결과: 초록색 안전                                      │
│                                                                     │
│   알림 방식:                                                        │
│   • 진동 패턴                                                       │
│   • 오버레이 UI 색상 변화                                           │
│   • 포그라운드 알림                                                 │
└─────────────────────────────────────────────────────────────────────┘
                                    ↓
┌─────────────────────────────────────────────────────────────────────┐
│               🔄 자동 종료 로직                                      │
│   • 4회 연속 위험 미감지 시 자동 종료                                │
│   • 통화 종료 후 위험 미감지 시 종료                                 │
│   • 수동 닫기 버튼으로 강제 종료                                     │
└─────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────┐
│                     🛠️ 주요 기술 스택                               │
│                                                                     │
│   AI/ML:                                                            │
│   • Whisper (음성인식) - OpenAI                                      │
│   • KoBERT (텍스트 분석) - 한국어 BERT                               │
│   • 딥보이스 탐지 모델 (합성음성 감지)                               │
│                                                                     │
│   Android:                                                          │
│   • MVVM 아키텍처                                                   │
│   • Foreground Service                                              │
│   • Accessibility Service                                           │
│   • Broadcast Receiver                                              │
│   • Overlay Window                                                  │
│                                                                     │
│   UI/UX:                                                            │
│   • Jetpack Compose                                                 │
│   • 실시간 플로팅 위젯                                               │
│   • 진동 패턴 피드백                                                │
└─────────────────────────────────────────────────────────────────────┘
